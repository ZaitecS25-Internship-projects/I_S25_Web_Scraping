<!--
Plantilla principal - Lista de departamentos

Muestra todos los departamentos disponibles en formato de tarjetas.
Cada tarjeta enlaza a la vista detallada del departamento.
Incluye botón para actualizar datos del BOE.
-->

{% extends 'base.html' %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
  <h2 class="mb-0">Departamentos</h2>
  {% if user %}
    <a href="{{ url_for('do_scrape') }}" class="btn btn-primary btn-update">
      Actualizar datos BOE
    </a>
  {% endif %}
</div>

<div class="row g-4">
  {% for dep in departamentos %}
    <div class="col-md-4 col-lg-3">
      <a href="{{ url_for('mostrar_departamento', nombre=dep['departamento']) }}" class="text-decoration-none">
        <div class="card h-100 shadow-sm tarjeta-departamento">
          <img src="{{ url_for('static', filename='img/' + dep['departamento']|replace(' ', '_') + '.avif') }}"
               class="card-img-top" alt="{{ dep['departamento'] }}"
               onerror="this.src='{{ url_for('static', filename='img/default.svg') }}'">
          <div class="card-body">
            <h5 class="card-title">{{ dep['departamento'] }}</h5>
          </div>
        </div>
      </a>
    </div>
  {% endfor %}
</div>

{% if not departamentos %}
  <div class="alert alert-info">
    No hay datos todavía.
    {% if user %}
      Pulsa <a href="{{ url_for('do_scrape') }}">Actualizar y notificar</a>.
    {% else %}
      Inicia sesión para actualizar.
    {% endif %}
  </div>
{% endif %}
{% endblock %} 