{% extends 'base.html' %}
{% block content %}
<div class="container py-5">
  <div class="row justify-content-center">
    <div class="col-md-5">
      <div class="card shadow">
        <div class="card-header bg-primary text-white py-3">
          <h3 class="mb-0 text-center"><i class="bi bi-shield-lock"></i> Nueva Contraseña</h3>
        </div>
        <div class="card-body p-4">
          <p class="text-muted mb-4">
            Introduce tu nueva contraseña para <strong>{{ email }}</strong>
          </p>
          
          <form method="post" novalidate>
            <div class="mb-3">
              <label class="form-label fw-bold">Nueva Contraseña</label>
              <div class="position-relative">
                <input class="form-control pe-5" type="password" name="new_password" id="password-new" 
                       minlength="6" required autofocus>
                <button class="btn position-absolute top-50 end-0 translate-middle-y border-0 bg-transparent" 
                        type="button" onclick="togglePasswordVisibility('new')" style="z-index: 10;">
                  <i class="bi bi-eye text-muted" id="eye-icon-new"></i>
                </button>
              </div>
              <small class="text-muted">Mínimo 6 caracteres</small>
            </div>

            <div class="mb-3">
              <label class="form-label fw-bold">Confirmar Contraseña</label>
              <div class="position-relative">
                <input class="form-control pe-5" type="password" name="confirm_password" id="password-confirm" 
                       minlength="6" required>
                <button class="btn position-absolute top-50 end-0 translate-middle-y border-0 bg-transparent" 
                        type="button" onclick="togglePasswordVisibility('confirm')" style="z-index: 10;">
                  <i class="bi bi-eye text-muted" id="eye-icon-confirm"></i>
                </button>
              </div>
            </div>

            <div class="d-grid">
              <button type="submit" class="btn btn-primary">
                <i class="bi bi-check-circle"></i> Restablecer Contraseña
              </button>
            </div>
          </form>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  function togglePasswordVisibility(fieldId) {
    const passwordField = document.getElementById('password-' + fieldId);
    const eyeIcon = document.getElementById('eye-icon-' + fieldId);

    if (passwordField.type === 'password') {
      passwordField.type = 'text';
      eyeIcon.classList.remove('bi-eye');
      eyeIcon.classList.add('bi-eye-slash');
    } else {
      passwordField.type = 'password';
      eyeIcon.classList.remove('bi-eye-slash');
      eyeIcon.classList.add('bi-eye');
    }
  }
</script>
{% endblock %}
